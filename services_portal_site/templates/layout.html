{% extends "layout_generic.html" %}
{% load ceda_user_tags %}

{% block head_title %}{% block page_title %}{% endblock %} | CEDA Services Portal{% endblock %}

{% block navbar_dropdown %}
  {% login_url as login_url %}
  {% logout_url as logout_url %}
  <div class="collapse navbar-collapse" id="navbarResponsive">
    <ul class="navbar-nav">
      <li class="nav-item">
        <a class="nav-link" href="https://catalogue.ceda.ac.uk">Search Catalogue</a>
      </li>
      <li class="nav-item">
        <a class="nav-link" href="https://data.ceda.ac.uk">Get Data</a>
      </li>
      <li class="nav-item">
        <a class="nav-link" href="https://help.ceda.ac.uk">Help</a>
      </li>
      <li class="nav-item">
        <a class="nav-link" href="https://archive.ceda.ac.uk/tools">Tools</a>
      </li>
      <li class="nav-item">
        <a class="nav-link" href="https://arrivals.ceda.ac.uk">Deposit</a>
      </li>
      <li class="nav-item">
        <a class="nav-link" href="https://ceda.ac.uk/blog/">News</a>
      </li>
    </ul>

    <ul class="navbar-nav ms-auto">
      <li class="nav-item dropdown">
        {% block user_status %}
          {% if login_url and logout_url %}
            {% get_userid as userid %}
            {% if userid %}
        {# Authenticated user #}
              <a class="nav-link dropdown-toggle ms-auto" href="#" role="button" data-bs-toggle="dropdown" aria-expanded="false">{{ userid }}</a>
              <ul class="dropdown-menu">
                <li><a class="dropdown-item" href="https://services.ceda.ac.uk/cedasite/myceda/user/"><i class="fa fa-user fa-fw"></i>My account</a></li>
                <li><a class="dropdown-item" href="https://services.ceda.ac.uk/cedasite/myceda/passwd/"><i class="fa fa-lock fa-fw"></i>Change password</a></li>
                {% logout_with_post as logout_with_post %}
                {% if logout_with_post %}
                <!-- The text colour doesn't change dynamically :( -->
                  <form action="{{ logout_url }}" method="post">
                    {% csrf_token %}
                    <button class="btn btn-link dropdown-item" type="submit"><i class="fa fa-sign-out-alt fa-fw"></i>Sign out</button>
                  </form>
                {% else %}
                  <li><a class="dropdown-item" href="{{ logout_url }}"><i class="fa fa-sign-out-alt fa-fw"></i>Sign out</a></li>
                {% endif %}
              </ul>
            {% else %}
        {# Unauthenticated user #}
              <a href="" class="nav-link dropdown-toggle" data-toggle="dropdown" role="button" aria-haspopup="true" aria-expanded="false">
                <i class="far fa-fw fa-user"></i> Sign in <span class="caret"></span>
              </a>
              <ul class="dropdown-menu">
                <li><a class="dropdown-item" href="{{ login_url }}"><i class="fa fa-fw fa-sign-in-alt"></i>Sign in</a></li>
                <li><a class="dropdown-item" href="https://services.ceda.ac.uk/cedasite/register/info/"><i class="fa fa-fw fa-user"></i>Register</a></li>
              </ul>
            {% endif %}
          {% endif %}
        {% endblock user_status %}
      </li>

    </ul>
  </div>
{% endblock navbar_dropdown %}

{% block footer %}
    {{ block.super }}
    <script type="text/javascript">!function(e,t,n){function a(){var e=t.getElementsByTagName("script")[0],n=t.createElement("script");n.type="text/javascript",n.async=!0,n.src="https://beacon-v2.helpscout.net",e.parentNode.insertBefore(n,e)}if(e.Beacon=n=function(t,n,a){e.Beacon.readyQueue.push({method:t,options:n,data:a})},n.readyQueue=[],"complete"===t.readyState)return a();e.attachEvent?e.attachEvent("onload",a):e.addEventListener("load",a,!1)}(window,document,window.Beacon||function(){});</script>
    <script type="text/javascript">window.Beacon('init', '0151e3db-1a06-48d6-a030-d1c605683be9')</script>
{% endblock footer %}